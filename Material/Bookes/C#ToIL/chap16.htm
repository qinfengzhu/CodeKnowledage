<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./chap16_files/filelist.xml">
<link rel=Edit-Time-Data href="./chap16_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Managed C++ - C# to IL</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:LastAuthor>Vijay Mukhi</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>42</o:TotalTime>
  <o:Created>2001-01-24T06:29:00Z</o:Created>
  <o:LastSaved>2001-01-24T06:30:00Z</o:LastSaved>
  <o:Pages>3</o:Pages>
  <o:Words>614</o:Words>
  <o:Characters>3196</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>399</o:Lines>
  <o:Paragraphs>199</o:Paragraphs>
  <o:CharactersWithSpaces>4302</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.Cbullets, li.Cbullets, div.Cbullets
	{mso-style-name:"C\#bullets";
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Cbase, li.Cbase, div.Cbase
	{mso-style-name:"C\#base";
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.Coutput, li.Coutput, div.Coutput
	{mso-style-name:"C\#output";
	mso-style-parent:"C\#base";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Cprg, li.Cprg, div.Cprg
	{mso-style-name:"C\#prg";
	mso-style-parent:"C\#base";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:9.5pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.ILbase, li.ILbase, div.ILbase
	{mso-style-name:ILbase;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.5pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.ILprg, li.ILprg, div.ILprg
	{mso-style-name:ILprg;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.ILoutput, li.ILoutput, div.ILoutput
	{mso-style-name:ILoutput;
	mso-style-parent:ILbase;
	mso-style-next:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
p.ILbullets, li.ILbullets, div.ILbullets
	{mso-style-name:ILbullets;
	mso-style-parent:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.5pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.cbasetext, li.cbasetext, div.cbasetext
	{mso-style-name:"c\# base text";
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:11.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
p.programs, li.programs, div.programs
	{mso-style-name:programs;
	mso-style-parent:"c\# base text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=Cbase><b><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt'><img
width=64 height=48 id="_x0000_i1025" src=bpb.jpg><o:p></o:p></span></b></p>

<p class=Cbase><b><span style='font-size:24.0pt;mso-bidi-font-size:10.0pt'>-16-</span></b><span
style='font-size:24.0pt;mso-bidi-font-size:10.0pt;color:windowtext'><o:p></o:p></span></p>

<p class=Cbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Cbase align=center style='text-align:center'><b><span
style='font-size:48.0pt'>Appendix 1</span></b><span style='font-size:30.0pt;
font-family:"Monotype Corsiva"'><o:p></o:p></span></p>

<p class=Cbase align=center style='text-align:center'><span style='font-size:
30.0pt;font-family:"Monotype Corsiva"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Cbase align=center style='text-align:center'><span style='font-size:
30.0pt;font-family:"Monotype Corsiva"'>Managed C++ </span><span
style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>There are many superficial
differences between programming languages. Minor modifications have been
carried out in the C++ programming language and, the modified language is called
Managed Extensions for C++. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg><u>a.cpp</u><o:p></o:p></p>

<p class=ILprg>#using &lt;mscorlib.dll&gt;<o:p></o:p></p>

<p class=ILprg>using namespace System;<o:p></o:p></p>

<p class=ILprg>void main()<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg>Console::WriteLine(&quot;hell&quot;);<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We specify the dll that contains
the code using a pre-processor directive #using. This pre-processor director
works in the same manner in Managed C++ as it does in C#. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The C/C++ languages support
global functions, and hence, Managed C++ also does so. Thus the function main
is used with the letter &quot;small m&quot;. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Static functions in C++ are
separated from the class name by the symbol &quot;::&quot; . The same syntax is
used here too. Thus, there is no variation from one .Net language to another,
and since they all compile finally to IL, we can all use the same WriteLine
function in any programming language that we like.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We compile the above program
a.cpp into an executable as follows:<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILoutput>&gt;cl /CLR a.cpp<o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>As before we run ildasm and get
the following output.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILprg>// VTableFixup Directory:<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">  
</span>IMAGE_COR_VTABLEFIXUP[0]:<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">       </span>RVA:<span
style="mso-spacerun: yes">               </span>00008038<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">       </span>Count:<span
style="mso-spacerun: yes">             </span>0001<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">       </span>Type:<span
style="mso-spacerun: yes">              </span>0005<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">         </span>[0000]<span
style="mso-spacerun: yes">            </span>(06000001)<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">  
</span>IMAGE_COR_VTABLEFIXUP[1]:<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">       </span>RVA:<span
style="mso-spacerun: yes">               </span>00008730<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">       </span>Count:<span
style="mso-spacerun: yes">             </span>0001<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">       </span>Type:<span
style="mso-spacerun: yes">              </span>0001<o:p></o:p></p>

<p class=ILprg>//<span style="mso-spacerun: yes">         </span>[0000]<span
style="mso-spacerun: yes">            </span>(06000002)<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg>.subsystem 0x00000003<o:p></o:p></p>

<p class=ILprg>.corflags 0x00000002<o:p></o:p></p>

<p class=ILprg>.vtfixup [1] int32 fromunmanaged at D_00008038 // 06000001<o:p></o:p></p>

<p class=ILprg>.vtfixup [1] int32 at D_00008730 // 06000002<o:p></o:p></p>

<p class=ILprg>.assembly extern mscorlib<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.originator = (03 68 91
16 D3 A4 AE 33 )<span style="mso-spacerun: yes">                 </span><o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.hash = (52 44 F8 C9 55
1F 54 3F 97 D7 AB AD E2 DF 1D E0 <o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">           </span>F2 9D 4F BC
)<span style="mso-spacerun: yes">                                   </span><o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.ver 1:0:2204:21<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>.assembly extern Microsoft.VisualC<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.originator = (03 68 91
16 D3 A4 AE 33 )<span style="mso-spacerun: yes">                </span><o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.hash = (A6 33 A5 3F A1
6E 0A F3 60 E1 22 E5 88 6E 72 5B<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">           </span>48 5F 71 98
)<span style="mso-spacerun: yes">                                  </span><o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.ver 7:0:9030:0<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>.assembly a as &quot;a&quot;<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.hash algorithm
0x00008004<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.ver 0:0:0:0<o:p></o:p></p>

<p class=ILprg>}<o:p></o:p></p>

<p class=ILprg>.module a.exe<o:p></o:p></p>

<p class=ILprg>// MVID: {588ADAE2-1C64-11D5-A55B-88B2F731D07B}<o:p></o:p></p>

<p class=ILprg>.class value private explicit ansi sealed $MultiByte$size$5<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">       </span>extends
[mscorlib]System.ValueType<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.pack 1<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.size 5<o:p></o:p></p>

<p class=ILprg>} // end of class $MultiByte$size$5<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg>//Global fields<o:p></o:p></p>

<p class=ILprg>//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<o:p></o:p></p>

<p class=ILprg>.field static privatescope value class $MultiByte$size$5
'unnamed-global-0$PST04000001' at D_00008030<o:p></o:p></p>

<p class=ILprg>//Global methods<o:p></o:p></p>

<p class=ILprg>//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<o:p></o:p></p>

<p class=ILprg>.method public static int32 modopt([mscorlib]System.Runtime.InteropServices.CallConvCdecl)<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">        </span>main() il managed<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.vtentry 1 : 1<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>// Code size<span
style="mso-spacerun: yes">       </span>17 (0x11)<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.maxstack<span
style="mso-spacerun: yes">  </span>1<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>IL_0000:<span
style="mso-spacerun: yes">  </span>ldsflda<span style="mso-spacerun: yes">   
</span>value class $MultiByte$size$5 'unnamed-global-0$PST04000001'<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>IL_0005:<span
style="mso-spacerun: yes">  </span>newobj<span style="mso-spacerun: yes">    
</span>instance void [mscorlib]System.String::.ctor(int8*)<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>IL_000a:<span
style="mso-spacerun: yes">  </span>call<span style="mso-spacerun: yes">      
</span>void [mscorlib]System.Console::WriteLine(class System.String)<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>IL_000f:<span
style="mso-spacerun: yes">  </span>ldc.i4.0<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>IL_0010:<span
style="mso-spacerun: yes">  </span>ret<o:p></o:p></p>

<p class=ILprg>} // end of global method main<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg>.method public static pinvokeimpl(/* No map */) <o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">        </span>unsigned int32
_mainCRTStartup() native unmanaged<o:p></o:p></p>

<p class=ILprg>{<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.entrypoint<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.custom instance void
System.Security.SuppressUnmanagedCodeSecurityAttribute::.ctor() = ( 01 00 00 00
) <o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>.vtentry 2 : 1<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>// Embedded native code<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>//<span
style="mso-spacerun: yes">  </span>Disassembly of native methods is not
supported.<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">  </span>//<span
style="mso-spacerun: yes">  </span>Managed TargetRVA = 0x1<o:p></o:p></p>

<p class=ILprg>} // end of global method _mainCRTStartup<o:p></o:p></p>

<p class=ILprg><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILprg>.data D_00008030 = bytearray (<o:p></o:p></p>

<p class=ILprg><span style="mso-spacerun: yes">                 </span>68 65 6C
6C 00 00 00 00)<span style="mso-spacerun: yes">                      </span><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The code is quite large, but
after reading it, you will realize that all the code generated in the .NET
family of languages is similar. Thus, we believe that those who know IL have a
great future in the world of computing.<o:p></o:p></span></p>

</div>

</body>

</html>
