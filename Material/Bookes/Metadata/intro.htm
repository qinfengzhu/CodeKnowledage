<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./intro_files/filelist.xml">
<link rel=Edit-Time-Data href="./intro_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Metadata Tables - Introduction</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Vijay Mukhi</o:Author>
  <o:LastAuthor>Vijay Mukhi</o:LastAuthor>
  <o:Revision>5</o:Revision>
  <o:TotalTime>20</o:TotalTime>
  <o:Created>2002-05-14T19:51:00Z</o:Created>
  <o:LastSaved>2002-02-18T20:12:00Z</o:LastSaved>
  <o:Pages>3</o:Pages>
  <o:Words>1170</o:Words>
  <o:Characters>6674</o:Characters>
  <o:Company>VMCI</o:Company>
  <o:Lines>55</o:Lines>
  <o:Paragraphs>13</o:Paragraphs>
  <o:CharactersWithSpaces>8196</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;
	mso-font-charset:0;
	mso-generic-font-family:script;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:30.0pt;
	font-family:"Monotype Corsiva";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.ILbase, li.ILbase, div.ILbase
	{mso-style-name:ILbase;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.ILbullets, li.ILbullets, div.ILbullets
	{mso-style-name:ILbullets;
	mso-style-parent:ILbase;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Bookman Old Style";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal><img width=64 height=48 id="_x0000_i1025" src=bpb.gif></p>

<p class=MsoCaption>Introduction<b><span style='font-size:24.0pt;font-family:
Impact'><o:p></o:p></span></b></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='color:windowtext'>This book on MetaData Tables is
a heady cocktail of the esoteric and mysterious details pertaining to the
internals of an executable file, which gets created by the compiler of any .Net
product.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>It is an intricate book, which
would appear formidable to those uninitiated to the world of C#. It is replete
with programs written using the C# language, and is predicated on the
presumption that you possess adequate knowledge of this language. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In the .Net world, when the
compiler processes the source code, it creates an IL file. This IL file is
inherently capable of comprehending object types. It is equipped with
instructions that do the following: create and initialize objects, call
methods, raise and catch exceptions, etc. This IL file is thereafter converted
into an executable or a DLL file, i.e. PE file, after the compiler has firmly
embedded the MetaData information in it. It is the repository of information
that relates to the types and the methods that have been employed in the file. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Earlier, Microsoft had extended
its original DOS format and had incorporated the PE file format in order to
buttress the execution of files on the Windows platform. However, with the
introduction of .Net, Microsoft remolded its PE file format and instituted a
header to store the MetaData information. Specifically, one of the structures
in the optional header has been used for the CLR header. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>MetaData is a key component that
casts a significant shadow on the .NET architecture. It renders the Runtime
with vital information about assemblies, classes, methods and scores of other
significant details. Thus, MetaData represents data, which is exacting,
comprehensive, and most importantly, language-independent. This results in a
common format for exposing the information contained in a file or an assembly,
thereby introducing flexibility and code sharing between applications that use
disparate languages. Finally, the MetaData facilitates remote method calls in
the .Net Framework.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Our book on 'MetaData Tables'
delineates how the MetaData is laid out after being read into memory from a PE
file. The MetaData is stored in either tables or streams. There are five
streams in all. One of the streams comprises of tables that store the relevant
data. The remaining four are String, Blob, UserString and Guid. There exists an
awesome amount of interdependence between these streams.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>All MetaData is stored
internally in the form of tables. There exist about 43 assorted table types in
the realm of MetaData, each of which stores specific information. For instance,
all the types are stored in one table, all the methods are stored in another
table, all the parameters are stored in yet another table, and so on. Each
table is assigned one bit in one of the MetaData fields. Contingent upon the
status of this bit field, the presence of a particular table can be ascertained.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Every table has been assigned a
name and a number. The table that is assigned the number 0 is known as
'Module', while the table that is assigned the number 1 is called TypeRef, and
so on. Moreover, Microsoft has extensively utilized the features of coded
indexes to enhance efficiency and to restrict the byte-consumption, thereby
avoiding dissipation of memory space. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The captivating feature of this
book is its remarkably simplistic approach. Firstly, we get you well acquainted
with the PE file format, where we introduce you to the relevant details of the
file. Then, we focus our attention on the Metadata header. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Next, we plough our way ahead,
scrutinizing every Metadata table meticulously, one at a time. On certain
occasions, we have replicated some portions of the code, in order to facilitate
ease of understanding. Further, to expound every table, miniature snippets of
code have been provided, using either IL or the C# language. An independent
chapter has been devoted to the topic of Blob Signatures, since they unravel an
altogether unique class of information.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>At times, we have undertaken
discursive diversions at crucial junctures to explain specific concepts, which
may not be directly related to the main topic. This has been done to provide a
holistic panorama of the .Net architecture. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Tables have been drawn and
screen shots have been provided to reinforce the assumptions and to illustrate
the concepts that have been proffered.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Finally, since no cross-connections
could be established between these tables while exploring each of them, we
chose to dedicate the last chapter to the display of all the linkages and to
provide values to the data stored in the table. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Although we are aware that there
is scope for extensive enhancement to make this book exhaustive, we chose to
wrap it up at this stage. This is because we hope that by the time you reach
the end of this book, you would have developed a penchant for Metadata tables
and<span style="mso-spacerun: yes">  </span>would be in a position to explore
the subject further by yourself. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In addition to the samples,
Microsoft has also offered a program called Metainfo, which provides a dump of
the Metadata. Another program utility that can be used is the disassembler,
known as the ILDASM. These two utilities can be used to verify and validate the
output of our program. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>We take immense pleasure in
proclaiming the fact that we are the pioneers in employing the C# language
while writing our metadata program. We are convinced that even the tools have
not been written in C#. Since our primary focus has been on the task of
discerning the tables and their contents, the chores of alignment and the
formatting have taken a back seat. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In order to serve up all this
information to you, we have scrutinized the Web in its entirety, and have
extracted meaningful inputs from it. Further, we have probed the unfathomable
depths of the 'uncomplicated' technical documentation provided by Microsoft.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Towards the latter part of this
book, we have inspected the intricacies of each and every bit, and have
investigated all the formatting issues. Once more, a program written in C#
comports itself like the ILDASM utility, providing substantial information
about every table and its field attributes. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>In conclusion, we reiterate that
this is a path-breaking book, which delves into the internals of the .Net
architecture, which is a virgin territory. We hope that you enjoy your journey
into this exotic domain and put the knowledge gained from this book to good
use. We are confident that this book will pave the way to sculpt you into an
aficionado of the .Net architecture. We wish you good luck and happy reading!<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><b><span style='mso-bidi-font-size:12.0pt;color:windowtext'>Minimum
Requirements</span></b><span style='color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>The software requirements to
successfully run all the programs in this book<span style="mso-spacerun: yes"> 
</span>are<o:p></o:p></span></p>

<p class=ILbase><span style='font-size:4.0pt;color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbullets><span style='font-size:14.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>  </span></span>Operating System - Windows 2000,
Windows XP </p>

<p class=ILbullets><span style='font-size:14.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>  </span></span>Visual Studio.Net or .Net Framework SDK</p>

<p class=ILbullets><span style='mso-bidi-font-size:12.0pt;font-family:"Times New Roman"'>•<span
style='mso-tab-count:1'>     </span></span>UltraEdit-32 (can be downloaded from
http://www.download.com)</p>

<p class=ILbullets><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=ILbase><span style='font-size:4.0pt;color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='font-family:"Monotype Corsiva";color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='font-size:20.0pt;font-family:"Monotype Corsiva";
color:windowtext'>Acknowledgements</span><span style='font-size:20.0pt;
color:windowtext'><o:p></o:p></span></p>

<p class=ILbase><span style='font-size:6.0pt;color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>I wish to thank a number of
people who gave me their support, new ideas and inspiration while writing this
book.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>First and foremost, thanks to </span><b><span
style='font-size:11.0pt;color:windowtext'>Manish Jain</span></b><span
style='color:windowtext'>, BPB Publications for publishing the book.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Special thanks to my co-authors,
</span><b><span style='font-size:11.0pt;color:windowtext'>Akash</span></b><span
style='color:windowtext'> and </span><b><span style='font-size:11.0pt;
color:windowtext'>Sonal</span></b><span style='color:windowtext'>, who have put
in their very best in the work assigned to them as without them and their
efforts<span style="mso-spacerun: yes">  </span>the book would have never seen
the light of day.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thanks to </span><b><span
style='font-size:11.0pt;color:windowtext'>Tanuja Sodhi</span></b><span
style='color:windowtext'>, an ex-naval officer from the first batch of lady
officers and an MBA from JBIMS for editing the book. She is presently
freelancing as a creative writer.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thanks to my cover designers, </span><b><span
style='font-size:11.0pt;color:windowtext'>Altaf Hemani</span></b><span
style='color:windowtext'> and </span><b><span style='font-size:11.0pt;
color:windowtext'>Kishore Rohra,</span></b><span style='color:windowtext'> for
designing the cover.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>Thanks to </span><b><span
style='font-size:11.0pt;color:windowtext'>Manish Purohit</span></b><span
style='color:windowtext'> for putting in all the time he had to verify the code
with the explanations and then giving the book a good look and feel. <o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>To </span><b><span
style='font-size:11.0pt;color:windowtext'>Shivanand Shetty</span></b><span
style='color:windowtext'>, who made it simple for me and my co-authors to come
up with the book. He has always been a source of inspiration and encouragement.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'>A long list of friends need a
mention here for their patience and cooperation on this book while it was being
written.<o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase align=right style='text-align:right'><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase align=right style='text-align:right'><span style='color:windowtext'><span
style="mso-spacerun: yes"> </span></span><b><span style='font-size:11.0pt;
color:windowtext'>-Vijay Mukhi<o:p></o:p></span></b></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=ILbase><span style='font-family:"Monotype Corsiva";color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

</div>

</body>

</html>
