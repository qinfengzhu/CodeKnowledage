#### Repositories仓库

“在域和数据映射层之间使用类似于接口的接口访问域对象”（Martin Fowler）。

实际上，存储库用于执行域对象的数据库操作（实体和值类型）。通常，每个实体都使用独立的存储库（或聚合根）。

> Default Repositories

`IRepository<TEntity, TPrimaryKey>` ,` IRepository<TEntity>` 仓库接口


> Managing Database Connection(管理数据库连接)

在自动进入存储库方法时，数据库连接被打开，事务开始。在方法结束时返回，所有的改变都被保存的，交易被提交与数据库的连接被关闭时自动通过ASP.NET样板。如果存储库方法抛出任何类型的异常，则事务将自动回滚，数据库连接已关闭。这类实现接口的所有公共方法的IRepository是真实的。

如果存储库方法调用另一个存储库方法（甚至是不同存储库的方法），它们共享相同的连接和事务。连接是通过进入存储库的第一个方法来管理（打开/关闭）的。在数据库连接管理的更多信息，参见UnitOfWork文档。

> Lifetime of a Repository(仓库的生命周期)

所有存储库实例都是暂时的。它意味着，每个使用都实例化它们。有关更多信息，请参见依赖注入文档。

对一个实体，使用IRepository <T>在可能的地方。除非真正需要，否则不要创建自定义存储库。预定义的存储库方法在很多情况下已经足够了。

存储库类应该是无状态的。这意味着，您不应该定义存储库级的状态对象，而存储库方法调用不应影响另一个调用。
自定义存储库方法不应包含业务逻辑或应用程序逻辑。它应该只执行与数据相关的或特定于ORM的任务。
虽然存储库可以使用依赖注入，但定义对其他服务的依赖性较少或不依赖
